---
title: "Applied Analytics - Assignment 2"
subtitle: "Analysis of Employee Turnover Tendency and Anxiety Level"
author: "Huu Thien Ngoc Phung - s3643808"
date: "Last updated: `r format(Sys.time(), '%d %B, %Y')`"
output:
  slidy_presentation:
    font_adjustment: -2
    highlight: haddock
    mathjax: "default"
    df_print: paged
---

```{r setup, include=FALSE}
# Use this chunk to quietly load your pacakges

knitr::opts_chunk$set(
	fig.align = "center",
	message = FALSE,
	warning = FALSE
)
# Packages loaded in this chunk will not appear in the presentation. 

library(readr)
library(dplyr)
library(kableExtra)
library(car)
library(knitr) # Useful for creating nice tables

```
# Introduction

- The following link will help you with creating R Markdown Slidy Presentations
- http://rmarkdown.rstudio.com/slidy_presentation_format.html
- Don't forget about [Bootcamp 4](https://astral-theory-157510.appspot.com/secured/RBootcamp_Course_04.html)
- A good introduction provides a brief background to the problem, defines important terms, and leads to a strong rationale. 
- Keep everything short and straight to the point. 
- Use bullet points to help minimise text.
- Add relevant images to make your presentation more appealing
- Remember, you have a maximum of 20 slides to fit everything in.
- Ensure each slide fits on one screen. The reader should not have to scroll down. 


# Problem Statement

- The purpose of this analysis/investigation is to ...
- State the overall problem/question driving the investigation
- Summarise how you will use statistics to solve the problem or answer your question.

# Data

- This analysis uses the data set 'turnover.csv' collected by Edward Babushkin, a Russian people analyst (Kaggle, 2020). 
- The data set containing 16 variables with the records of 1,129 employees working in different industries including their score for each of the big five personality trait. 
- For this investigation, we subset the data set with only 3 variables of interest, their column names and data types are:

  * **event** [factor]: the employee turnover event, '0' means the employee stayed with the company, '1' means the employee quitted.
  * **industry** [character]: the industry that the employee was working in.
  * **anxiety** [numeric]: anxiety score, used to measure personality trait of neuroticism. Values are scaled from 1 to 10, the higher the score, the more anxious the employee appeared to be.

```{r}
turnoverfull <- read_csv("turnover.csv")
turnover <- turnoverfull %>% select(event, industry, anxiety)
head(turnover)
```


# Data Cont.

- Convert the data type of 'event' from character to 'factor' with 2 levels 'Stay' for employees who stayed with the company, and 'Quit' for employees who left the organization.

```{r}
turnover$event %>% unique()
turnover$event <- turnover$event %>%
  factor(levels = c(0,1), 
         labels = c("Stay", "Quit"))
levels(turnover$event)
```
<p>&nbsp;</p>

- No values was found to be missing values and special values.

```{r}
colSums(is.na(turnover))
is.special <- function(x){
if (is.numeric(x)) (is.infinite(x) | is.nan(x))
}
sum(is.special(turnover$anxiety))
```



# Descriptive Statistics and Visualisation


::: columns

:::: column


```{r fig.dim = c(4.5,4)}
bp1 <- boxplot(turnover$anxiety ~ turnover$event, col="dodgerblue3", 
               horizontal = TRUE, xlab = "Anxiety Score", ylab = "Turnover Event",
               main = "Box Plots of Anxiety Score \nby Turnover Event")
```


::::

:::: column

As we are investigating the anxiety score for each of the event groups (Stay vs Quit), the bivariate boxplots technique is applied to compare the employee anxiety score distribution for each event group and detect potential outliers using Tukey's method of outlier detection.


**Interpretation of the Box Plots**

- The two box plots shows that even though the first quartile and third quartile of Quit group anxiety score is lower than Stay group's, the median anxiety score in both groups are similar.
- The interquartile ranges of the anxiety score in both groups as shown by the lengths of the boxes are reasonably similar.
- However, the whisker of Stay group is larger than that of Quit group, indicated a wider distribution in anxiety score in Stay group.
- Anxiety score of Quit group appear to be left-skew, and that of Stay group appear to be right-skew.
- There are 3 detected outliers lying above the Quit group upper fence, all with value of 10.

```{r}
bp1$out
```

::::

:::


# Descriptive Statistics Cont.

**Handling outliers**

-  First, subset the 'turnover' data frames into 2 new data frames which are 'Stayed' containing all employees who stayed with their organization and 'Left' containing all employees who quit from their job.

```{r}
Stayed <- turnover %>% filter(event=="Stay")
Quitted <- turnover %>% filter(event=="Quit")
dim(Quitted)
```
<p>&nbsp;</p>

- As there are only 3 outliers (as shown from the box plot) out of 571 observations in Quitted group, removing these outliers would be a safe approach without biasing the analysis. 
- Next, excluding 3 observations considered as outliers  from 'Quitted' data frame using Tukey's method.

```{r}
Quitted <- Quitted[!Quitted$anxiety > quantile(Quitted$anxiety, 0.75) + 
                         1.5*IQR(Quitted$anxiety), ]
dim(Quitted)
```

<p>&nbsp;</p>

- After removing the 3 outliers, combine the 'Stayed' and 'Quitted' into new data frame 'turnover_clean'.
```{r}
turnover_clean <- bind_rows(Stayed, Quitted)
str(turnover_clean)
```


# Descriptive Statistics Cont.

**After removing outliers**

- Box Plots of Anxiety Score by Turnover Event

```{r fig.dim = c(6,4)}
bp2 <- boxplot(turnover_clean$anxiety ~ turnover_clean$event, col="dodgerblue3", 
               horizontal = TRUE, xlab = "Anxiety Score", ylab = "Turnover Event",
               main = "Box Plots of Anxiety Score \nby Turnover Event")
```



# Decsriptive Statistics Cont.
**Summary Statistics**

::: columns

:::: column


```{r}
turnover_clean %>% group_by(`Turnover Event` = event) %>% 
  summarise(Min = min(anxiety,na.rm = TRUE),
            Q1 = quantile(anxiety,probs = .25,na.rm = TRUE),
            Median = median(anxiety, na.rm = TRUE),
            Q3 = quantile(anxiety,probs = .75,na.rm = TRUE),
            Max = max(anxiety,na.rm = TRUE),
            Mean = round(mean(anxiety, na.rm = TRUE),2),
            IQR = IQR(anxiety,na.rm = TRUE),
            SD = round(sd(anxiety, na.rm = TRUE),2),
            n = n(),
            Missing = sum(is.na(anxiety))) -> tab1
tab1 %>% kbl(caption = "Table 1: Summary Statistics of Anxiety Score") %>% 
  kable_classic_2(full_width = F) %>% 
  row_spec(0,bold=TRUE, color="brown") %>% 
  column_spec(1, bold=TRUE, color="brown")
```
::::

:::: column

- Table 1 showed summary statistics of anxiety score for each turnover event group.
- The minimum value and median value of both groups are similar at 1.7 and 5.6 respectively.
- Stay group has higher maximum value of anxiety score than Quit group (10>9.4).
- The interquartile range of both group are the same which is 2.3. However, the first quartile Q1 and third quartile Q3 of Stay group are 4.8 and 7.1 respectively are both higher than the corresponding statistics in Quit group, which are 4 and 6.3 respectively.
- The mean anxiety score of Stay group is 5.77, higher than the mean of Quit group which is 5.54.
- The standard deviation of Stay group is 1.68, very close to the standard deviation of Quit group which is 1.7.
- For Stay group, the mean score (5.77) is higher than the median score (5.6), suggested that the distribution of anxiety score in Stay group is right skewed.
- For Quit group, the mean score (5.54) is lower than the median score (5.6), suggested that the distribution of anxiety score in Quit group is left skewed.

::::

:::

# Hypothesis Testing

- In order to compare  the mean anxiety score of two employee groups (Stay and Leave), two-tailed two-sample t-test is applied. 
- Before conducting the two-sample t-test, the normality assumption and variance homogeneity assumption need to be checked.

---

::: columns

:::: column

# Hypothesis Testing Cont.

**Testing the Assumption of Normality for Stay Group**

- Q-Q Plots & Histogram of Anxiety Score for Stay Group.

```{r, fig.show='hide'}
par(mfrow=c(2,1))
Stayed$anxiety %>% qqPlot(dist="norm", main = "Distribution of Stayed_Anxiety Score")
Stayed$anxiety %>% hist(col="dodgerblue3",  xlab="Anxiety Score",
                        main = "Histogram of Stayed_Anxiety Score") 
par(mfrow=c(1,1))
```

- The Q-Q plots suggested that the anxiety score distributions for both employee groups are not normal as there are many points falling outside the 95% CI for the normal quantiles.
- The histograms also suggested that

::::

:::: column

```{r, echo=FALSE, results='hide', fig.dim = c(5,6.5)}
par(mfrow=c(2,1))
Stayed$anxiety %>% qqPlot(dist="norm", main = "Distribution of Stayed_Anxiety Score")
Stayed$anxiety %>% hist(col="dodgerblue3",  xlab="Anxiety Score",
                        main = "Histogram of Stayed_Anxiety Score") 
par(mfrow=c(1,1))
```


::::

:::

---

::: columns

:::: column

# Hypothesis Testing Cont.

**Testing the Assumption of Normality for Quit Group**

- Q-Q Plots & Histogram of Anxiety Score for Quit Group.

```{r, fig.show='hide'}
par(mfrow=c(2,1))
Quitted$anxiety %>% qqPlot(dist="norm", main = "Distribution of Quitted_Anxiety Score")
Quitted$anxiety %>% hist(col="dodgerblue3", xlab="Anxiety Score",
                      main = "Histogram of Quitted_Anxiety Score") 
par(mfrow=c(1,1))
```

- The Q-Q plots suggested that the anxiety score distributions for both employee groups are not normal as there are many points falling outside the 95% CI for the normal quantiles.
- The histograms also suggested that

::::

:::: column

```{r, echo=FALSE, results='hide', fig.dim = c(5,6.5)}
par(mfrow=c(2,1))
Quitted$anxiety %>% qqPlot(dist="norm", main = "Distribution of Quitted_Anxiety Score")
Quitted$anxiety %>% hist(col="dodgerblue3", xlab="Anxiety Score",
                      main = "Histogram of Quitted_Anxiety Score")
par(mfrow=c(1,1))
```


::::

:::


# Hypothesis Testing Cont.
**Homogeneity of Variance**
$$H_0: \sigma_1^2 = \sigma_2^2$$
$$H_A: \sigma_1^2 \ne \sigma_2^2$$

where $\sigma_1^2$ and $\sigma_2^2$ refer to the population variance of group 1 and group 2 respectively.

```{r}
leveneTest(anxiety ~ event, data = turnover_clean)
```


- The p-value for the Levene's test of equal variance for anxiety score between employees who stayed and who left is p=0.77. As p > 0.05, we fail to reject $H_0$. Therefore, it is safe to assume equal variance.

# Hypthesis Testing Cont.
**Two-sample t-test - Assuming Equal Variance**

- Here are the examples of mathematical equations:

$$H_0: \mu_1 = \mu_2 $$

$$H_A: \mu_1 \ne \mu_2$$


```{r}
t.test(anxiety ~ event, data = turnover_clean, var.equal = TRUE, alternative = "two.sided")
```


# Discussion

- Discuss the major findings of your investigation
- Discuss any strengths and limitations. 
- Propose directions for future investigations. 
- This is a good place to re-state your findings as a final conclusion. What is the one take home message the reader should leave with?
- Your final conclusion needs to be very clear.

# References

- Provide a list of any references you use in the presentation. 
- https://www.kaggle.com/davinwijaya/employee-turnover